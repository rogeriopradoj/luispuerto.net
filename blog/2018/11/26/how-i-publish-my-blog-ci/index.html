<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html -->

<title>How I publish my blog: Using Continuous Integration with Jekyll | Luis Puerto</title>
<meta name="description" content="As I’ve mentioned before, this blog is build as a static website with Jekyll, which allow me not to worry about data bases, logins or anything of the sorts when I’m publishing and managing the web. I use the free tier of GitHub Pages as hosting, which has its downsides and upsides. The main upside is, it’s really convenient and free. On the other hand, I’m limited to certain Jekyll plugins if I want to use GitHub Pages building capabilities. This can be circumnavigate if you use CI (Continuous Integration) to build your site.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Luis Puerto">
<meta property="og:title" content="How I publish my blog: Using Continuous Integration with Jekyll">
<meta property="og:url" content="https://luispuerto.net/blog/2018/11/26/how-i-publish-my-blog-ci/">


  <meta property="og:description" content="As I’ve mentioned before, this blog is build as a static website with Jekyll, which allow me not to worry about data bases, logins or anything of the sorts when I’m publishing and managing the web. I use the free tier of GitHub Pages as hosting, which has its downsides and upsides. The main upside is, it’s really convenient and free. On the other hand, I’m limited to certain Jekyll plugins if I want to use GitHub Pages building capabilities. This can be circumnavigate if you use CI (Continuous Integration) to build your site.">



  <meta property="og:image" content="https://luispuerto.net/assets/images/blog/2018/jekyll+travis.png">



  <meta name="twitter:site" content="@lpuerto">
  <meta name="twitter:title" content="How I publish my blog: Using Continuous Integration with Jekyll">
  <meta name="twitter:description" content="As I’ve mentioned before, this blog is build as a static website with Jekyll, which allow me not to worry about data bases, logins or anything of the sorts when I’m publishing and managing the web. I use the free tier of GitHub Pages as hosting, which has its downsides and upsides. The main upside is, it’s really convenient and free. On the other hand, I’m limited to certain Jekyll plugins if I want to use GitHub Pages building capabilities. This can be circumnavigate if you use CI (Continuous Integration) to build your site.">
  <meta name="twitter:url" content="https://luispuerto.net/blog/2018/11/26/how-i-publish-my-blog-ci/">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://luispuerto.net/assets/images/blog/2018/jekyll+travis.png">
  

  



  <meta property="article:published_time" content="2018-11-26T08:07:00+00:00">





  

  


<link rel="canonical" href="https://luispuerto.net/blog/2018/11/26/how-i-publish-my-blog-ci/">





  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "url": "https://luispuerto.net",
      "logo": "https://luispuerto.net/assets/images/pages/header-splash.jpg"
    }
  </script>



  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Luis Puerto",
      "url": "https://luispuerto.net",
      "sameAs": ["https://twitter.com/lpuerto","https://www.linkedin.com/in/lpuerto","https://github.com/luispuerto","https://www.flickr.com/photos/lpuerto"]
    }
  </script>



  <meta name="google-site-verification" content="cZLLZlgNzUnRDZVt90lZpruDWIKI7ccL3GmK4E3hXKI" />





<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Luis Puerto Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- Font Mr. Dafoe for Landing Page -->
<link href="https://fonts.googleapis.com/css?family=Mr+Dafoe" rel="stylesheet">

<!-- Mathjax to show equations from Latex code -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">Luis Puerto</a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/">Home</a>
            </li>
<li class="masthead__menu-item">
              <a href="/aboutme">About Me</a>
            </li>
<li class="masthead__menu-item">
              <a href="/resume">Résumé</a>
            </li>
<li class="masthead__menu-item">
              <a href="/blog">Blog</a>
            </li>
<li class="masthead__menu-item">
              <a href="/archive">Archive</a>
            </li>
<li class="masthead__menu-item">
              <a href="/contact">Contact</a>
            </li>
</ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  

















<div class="page__hero--overlay" style="
          background-image:
            linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)),
            url('/assets/images/blog/2018/jekyll+travis.png');
          ">
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        
          How I publish my blog: Using Continuous Integration with Jekyll

        
      </h1>
      
      <!-- 
        <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  7 minute read
</p>
       -->
      
      
    </div>
  
  
    <span class="page__hero-caption">Jekyll and Travis logos
</span>
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        
        <a href="/aboutme/">
          <img src="/assets/images/pages/20121231-035-ol.jpg" alt="Luis Puerto" itemprop="image">
        </a>
      
    </div>
  

  <div class="author__content">
    
      <a href="/aboutme/"><h3 class="author__name" itemprop="name">Luis Puerto</h3></a>
    
    
      <p class="author__bio" itemprop="description">
        Born in Ponferrada, Spain. A Forest Engineer interested in Science and Technology. Fascinated about almost everything
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name"><img class="emoji" title=":eu:" alt=":eu:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f1ea-1f1fa.png" height="20" width="20"><img class="emoji" title=":es:" alt=":es:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f1ea-1f1f8.png" height="20" width="20"><img class="emoji" title=":sweden:" alt=":sweden:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f1f8-1f1ea.png" height="20" width="20"><img class="emoji" title=":finland:" alt=":finland:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f1eb-1f1ee.png" height="20" width="20"><img class="emoji" title=":us:" alt=":us:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f1fa-1f1f8.png" height="20" width="20"></span>
        </li>
      

      

      

      
        
          
            <li><a href="/aboutme/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-user-circle" aria-hidden="true"></i> About me</a></li>
          
        
          
            <li><a href="mailto:luis@luispuerto.net" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope" aria-hidden="true"></i> Email</a></li>
          
        
          
            <li><a href="https://twitter.com/lpuerto" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/lpuerto" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
          
        
          
            <li><a href="https://github.com/luispuerto" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
            <li><a href="https://instagram.com/lpuerto" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="How I publish my blog: Using Continuous Integration with Jekyll">
    <meta itemprop="description" content="As I’ve mentioned before, this blog is build as a static website with Jekyll, which allow me not to worry about data bases, logins or anything of the sorts when I’m publishing and managing the web. I use the free tier of GitHub Pages as hosting, which has its downsides and upsides. The main upside is, it’s really convenient and free. On the other hand, I’m limited to certain Jekyll plugins if I want to use GitHub Pages building capabilities. This can be circumnavigate if you use CI (Continuous Integration) to build your site.">
    <meta itemprop="datePublished" content="Monday, 26 November 2018 08:07 UTC">
    

    <div class="page__inner-wrap">
      

      
        <p class="page__meta page__reading_time">
          
          
              <strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Posted:</strong> <time datetime="2018-11-26T08:07:00+00:00">Monday, 26 November 2018 08:07 UTC</time>
          
          
        
          <strong><i class="far fa-clock" aria-hidden="true"></i></strong> 




  7 minute read

        
        </p>
      

        

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> On this page</h4></header>
              
              <ul class="toc__menu back__top"><li><a href="#">Back to Top</a></li></ul>
              
              <ul class="toc__menu">
  <li><a href="#what-is-continuous-integration">What is Continuous Integration?</a></li>
  <li>
<a href="#how">How?</a>
    <ul>
      <li><a href="#give-access-to-travis">Give access to Travis</a></li>
      <li><a href="#configure-your-build">Configure your build</a></li>
      <li><a href="#deploy">Deploy</a></li>
    </ul>
  </li>
  <li><a href="#why">Why?</a></li>
  <li><a href="#lfs">LFS?</a></li>
</ul>
            </nav>
          </aside>
        
        <div class="post__content">
          <p>As I’ve mentioned <a href="/blog/2018/07/23/new-web-in-jekyll/">before</a>, this blog is build as a <a href="https://en.wikipedia.org/wiki/Static_web_page">static website</a> with <a href="https://jekyllrb.com">Jekyll</a>, which allow me not to worry about data bases, logins or anything of the sorts when I’m publishing and managing the web. I use the free tier of <a href="https://pages.github.com">GitHub Pages</a> as hosting, which has its downsides and upsides. The main upside is, it’s really convenient and free. On the other hand, I’m limited to <a href="https://pages.github.com/versions/">certain Jekyll plugins</a> if I want to use GitHub Pages building capabilities. This can be circumnavigate if you use CI (Continuous Integration) to build your site.</p>

<h2 id="what-is-continuous-integration">What is Continuous Integration?</h2>

<p>You can read more about this in the <a href="https://en.wikipedia.org/wiki/Continuous_integration">Wikipedia</a> —and in <a href="https://docs.travis-ci.com/user/for-beginners/#what-is-continuous-integration-ci">Travis documentation</a>— but CI is basically —and I’m summarizing a lot here— just testing your code before you <em>integrate</em> —merge— it with the master branch, so you know that you aren’t breaking anything —serious. Usually what you do is <em>building</em> your copy and then you merge it with the <code class="highlighter-rouge">master</code> branch. However, building is a pain, and even more if you have to do it all the time —continuously. For this reason, the CI services were born.</p>

<p>Usually a CI works as it follows —again simplified:</p>

<ol>
  <li>It’s usually related / connected to your online repo and when you push commits to the repo the <a href="https://en.wikipedia.org/wiki/Webhook">webhooks</a> are triggered and CI comes into action.</li>
  <li>CI download the last commits of your repo to a machine —usually virtual— with an OS you can specify and begin tu run a series of scripts<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup> to test and to build your software from the last commit you’ve pushed.</li>
  <li>If those scripts give an error, so your code can’t be <em>build</em>, report to you as failing and —bad luck— you have to review what you have done because it’s not working.</li>
  <li>If the scripts exit without an error —you’re lucky— and now a couple of things can happen.
    <ul>
      <li>Just nothing else. You are notify there is not errors in your code —so you are free to merge.</li>
      <li>The code is automatically deployed.
        <ul>
          <li>It’s merged into another branch —usually <code class="highlighter-rouge">master</code>.</li>
          <li>It’s deploy to a server or something else.</li>
        </ul>
      </li>
    </ul>
  </li>
</ol>

<p>All of these steps have a lot of sense in GitHub, GitLab and other repo online services where webhooks can be triggered even with a pull request, so you can know beforehand if someone else code is worth to review in an even of a pull request.</p>

<p>That’s more of less the official function of the CI. However, it can do much more than that. For example, in the Homebrew repos/taps it builds the bottles and deploys them to a hosting so you can latter download them. It can build software and apps and deploy it to your website. Or like in our case can build your Jekyll site and deploy to GitHub Pages.</p>

<h2 id="how">How?</h2>

<p>There are several options out there as CI services, from <a href="https://travis-ci.com">Travis</a> —with is one of the most common one— to <a href="https://jenkins.io">Jenkins</a> or, if you use <a href="https://about.gitlab.com/product/continuous-integration/">GitLab, their own CI</a>. I’m going to talk about Travis, because it’s the one I’m using myself and usually is the easier option. You can use Travis for free on the condition <a href="https://travis-ci.com/plans">your project is open source</a>.</p>

<h3 id="give-access-to-travis">Give access to Travis</h3>

<p>First of all, you should go to the Travis website and authorize them to have access to your repos in GitHub. Usually, you just need to login with your GitHub account; they will ask for permission and if you just want to use Travis in all your repos or in just some of the repos. I have it set for only the repos I’m interested on because otherwise Travis can be trigged just pushing a commit to GitHub<sup id="fnref:2"><a href="#fn:2" class="footnote">2</a></sup>.</p>

<h3 id="configure-your-build">Configure your build</h3>

<p>Once you have given access to Travis to the repo where you have your Jekyll page, you need to configure your build. You configure your build with the file <code class="highlighter-rouge">.travis.yml</code> in the root of your repo.</p>

<p>Here is mine right now:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td>
<td class="rouge-code"><pre><span class="c1"># .travis.yml</span>
<span class="c1"># This file should be at the root of your project</span>
<span class="c1">#</span>
<span class="ss">language: </span><span class="n">ruby</span>
<span class="ss">rvm:
 </span><span class="o">-</span> <span class="mf">2.5</span><span class="o">.</span><span class="mi">3</span>
<span class="ss">cache:
  bundler: </span><span class="kp">true</span>
  <span class="c1"># directories:</span>
  <span class="c1">#   - $TRAVIS_BUILD_DIR/tmp/.htmlproofer</span>
<span class="ss">before_install:
  </span><span class="o">-</span> <span class="n">gem</span> <span class="n">install</span> <span class="n">bundler</span>
<span class="ss">gemfile: </span><span class="no">Gemfile</span>
<span class="ss">script:
  </span><span class="o">-</span> <span class="k">if</span> <span class="p">[</span> <span class="s2">"$TRAVIS_BRANCH"</span> <span class="o">=</span> <span class="s2">"master"</span> <span class="p">];</span> <span class="k">then</span>
      <span class="n">bundle</span> <span class="nb">exec</span> <span class="n">jekyll</span> <span class="n">algolia</span><span class="p">;</span> 
      <span class="no">JEKYLL_ENV</span><span class="o">=</span><span class="n">production</span> <span class="n">bundle</span> <span class="nb">exec</span> <span class="n">jekyll</span> <span class="n">build</span><span class="p">;</span> 
      <span class="n">bundle</span> <span class="nb">exec</span> <span class="n">htmlproofer</span> <span class="p">.</span><span class="nf">/</span><span class="n">_site</span> <span class="o">--</span><span class="n">alt_ignore</span> <span class="s2">"/.*/"</span> <span class="o">--</span><span class="n">allow_hash_href</span> <span class="o">--</span><span class="n">http</span><span class="o">-</span><span class="n">status</span><span class="o">-</span><span class="n">ignore</span> <span class="mi">999</span> <span class="o">--</span><span class="n">disable</span><span class="o">-</span><span class="n">external</span><span class="p">;</span>
      <span class="n">fi</span> 
  <span class="o">-</span> <span class="k">if</span> <span class="p">[</span> <span class="s2">"$TRAVIS_BRANCH"</span> <span class="o">=</span> <span class="s2">"develop"</span> <span class="p">];</span> <span class="k">then</span>
      <span class="no">JEKYLL_ENV</span><span class="o">=</span><span class="n">production</span> <span class="n">bundle</span> <span class="nb">exec</span> <span class="n">jekyll</span> <span class="n">build</span><span class="p">;</span> 
      <span class="n">bundle</span> <span class="nb">exec</span> <span class="n">htmlproofer</span> <span class="p">.</span><span class="nf">/</span><span class="n">_site</span> <span class="o">--</span><span class="n">alt_ignore</span> <span class="s2">"/.*/"</span> <span class="o">--</span><span class="n">allow_hash_href</span> <span class="o">--</span><span class="n">http</span><span class="o">-</span><span class="n">status</span><span class="o">-</span><span class="n">ignore</span> <span class="mi">999</span> <span class="o">--</span><span class="n">disable</span><span class="o">-</span><span class="n">external</span><span class="p">;</span>
      <span class="n">fi</span> 
<span class="ss">branches:
  only:
    </span><span class="c1"># Change this to gh-pages if you're deploying using the gh-pages branch</span>
    <span class="o">-</span> <span class="n">master</span>
    <span class="o">-</span> <span class="n">develop</span>
<span class="ss">env:
  global:
  </span><span class="o">-</span> <span class="no">NOKOGIRI_USE_SYSTEM_LIBRARIES</span><span class="o">=</span><span class="kp">true</span> <span class="c1"># speeds up installation of html-proofer</span>

<span class="ss">sudo: </span><span class="kp">false</span> <span class="c1"># route your build to the container-based infrastructure for a faster build</span>

<span class="ss">deploy:
  provider: </span><span class="n">pages</span>
  <span class="n">skip</span><span class="o">-</span><span class="ss">cleanup: </span><span class="kp">true</span>
  <span class="n">github</span><span class="o">-</span><span class="ss">token: </span><span class="vg">$GITHUB_TOKEN</span>  <span class="c1"># Set in the settings page of your repository, as a secure variable</span>
  <span class="n">keep</span><span class="o">-</span><span class="ss">history: </span><span class="kp">false</span>
  <span class="ss">local_dir: </span><span class="n">_site</span>
  <span class="c1"># repo: luispuerto/luispuerto.net # in case I wanted to build my page in other repo</span>
  <span class="n">target</span><span class="o">-</span><span class="ss">branch: </span><span class="n">gh</span><span class="o">-</span><span class="n">pages</span>
  <span class="ss">on:
    branch: </span><span class="n">master</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p>You can learn more about how to create your own configuration file on <a href="https://docs.travis-ci.com">Travis Documentation</a>, but I’ll walk you through my config:</p>

<ul>
  <li>
<a href="https://docs.travis-ci.com/user/tutorial/#selecting-a-different-programming-language"><code class="highlighter-rouge">language</code></a>: The language we are going to use in the build. In our case is Ruby, because Jekyll is build in Ruby.</li>
  <li>
<a href="https://docs.travis-ci.com/user/languages/ruby/#Supported-Ruby-Versions"><code class="highlighter-rouge">rvm</code></a>: is the version of ruby we want to use. I’m using the last one —at this moment— 2.5.3. I don’t know if you can set it up to use the last stable one, but some people argue that it isn’t a good idea and you should set the version so it match the one in your machine —which has sense</li>
  <li>
<a href="https://docs.travis-ci.com/user/caching/"><code class="highlighter-rouge">cache</code></a>: You can cache content that usually don’t change. In our case we are caching the bundle install because usually the gems we need don’t change that often.</li>
  <li>
<a href="https://docs.travis-ci.com/user/installing-dependencies/"><code class="highlighter-rouge">before_install</code></a>: Before we install the gems we are going to need to build our page we need to install the <a href="https://jekyllrb.com/tutorials/using-jekyll-with-bundler/"><code class="highlighter-rouge">bundle</code></a>.</li>
  <li>
<a href="https://docs.travis-ci.com/user/languages/ruby/"><code class="highlighter-rouge">gemfile</code></a>: Location of the gemfile, so Travis knows what gems should install.</li>
  <li>
    <p><a href="https://docs.travis-ci.com/user/languages/ruby"><code class="highlighter-rouge">script</code></a>: This is the script to build. In ruby the default script is your rake file, but you can define anything else here —like a shell script which is much more simple. As you see I have a couple of entries here that run depending on the branch it’s pushed.</p>

    <ul>
      <li>When I push <code class="highlighter-rouge">master</code> I run <a href="https://community.algolia.com/jekyll-algolia/github-pages.html">Algolia</a>, build the site and then past the <a href="https://github.com/gjtorikian/html-proofer">htmlproofer</a>.</li>
      <li>When I push <code class="highlighter-rouge">develop</code> I just build the site and past the <a href="https://github.com/gjtorikian/html-proofer">htmlproofer</a>.</li>
    </ul>

    <p class="notice--warning"><strong>Please remember</strong> to build your site with <code class="highlighter-rouge">JEKYLL_ENV=production</code> because if you don’t some features aren’t going to show in the final deployment.</p>
  </li>
  <li>
<a href="https://docs.travis-ci.com/user/customizing-the-build/#building-specific-branches"><code class="highlighter-rouge">branches</code></a>: This define which branches trigger the build. In my case <code class="highlighter-rouge">master</code> and <code class="highlighter-rouge">develop</code>, but you can add/remove whatever you want.</li>
  <li>
<a href="https://docs.travis-ci.com/user/customizing-the-build/"><code class="highlighter-rouge">env</code></a>: You can define environment variables and in my case since I’m using <a href="https://github.com/gjtorikian/html-proofer">htmlproofer</a> it’s <a href="https://jekyllrb.com/docs/continuous-integration/travis-ci/">recommended</a> to use <code class="highlighter-rouge">NOKOGIRI_USE_SYSTEM_LIBRARIES</code> as environment variable.</li>
  <li>
<a href="https://docs.travis-ci.com/user/tutorial/#selecting-infrastructure-optional"><code class="highlighter-rouge">sudo</code></a>: We don’t need sudo, since we don’t need customizations.</li>
</ul>

<h3 id="deploy">Deploy</h3>

<p>This is the last part of the config file, which is going to deploy the final built product —your website— to your repo again but in a different branch —<code class="highlighter-rouge">gh-pages</code> in my case. Travis <a href="https://docs.travis-ci.com/user/deployment/pages/">has a section</a> in its documentation about deployment in GitHub Pages.</p>

<p>Just a <em>couple</em> of notes:</p>

<ul>
  <li>
<code class="highlighter-rouge">on</code>: States the branch is going to trigger the build it’s the previous test exit with no errors. In other words, only when you push commits to <code class="highlighter-rouge">master</code> Travis is going to deploy your site. If you run Travis in other branches the deployment isn’t going to happen.</li>
  <li>
<code class="highlighter-rouge">target_branch</code>: This is where is going to be deployed your site. In my case I have a branch only for deployments <code class="highlighter-rouge">gh-pages</code> which I don’t even have locally. Be aware that Travis push with <code class="highlighter-rouge">--force</code> to that branch so it’s going to overwrite the history in that branch leaving just one commit.</li>
  <li>
<code class="highlighter-rouge">repo</code>: You can deploy in a different repo if you want, just define username and name of the repo.</li>
  <li>
<code class="highlighter-rouge">local_dir</code>: Folder from the build that is needed to be deployed, <code class="highlighter-rouge">_site</code> in my case.</li>
  <li>
<code class="highlighter-rouge">keep-history</code>: If you don’t want Travis to push with <code class="highlighter-rouge">--force</code> you can set this option to true and it’ll will keep the history of your branch.</li>
  <li>
<code class="highlighter-rouge">github-token</code>: You need to provide Travis with a <a href="https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/">GitHub personal access token</a> with the <code class="highlighter-rouge">public_repo</code> or <code class="highlighter-rouge">repo</code> scope, depending if you repo is public or private. This token should be private and the best way use it is to configure it in your <a href="https://docs.travis-ci.com/user/environment-variables#defining-variables-in-repository-settings">repository settings</a> in Travis. If you don’t provide the token correctly, Travis isn’t going to be able to deploy.</li>
  <li>
<code class="highlighter-rouge">skip-cleanup</code>: You need to set this up as <code class="highlighter-rouge">true</code> if you don’t want Travis to delete everything after it finish the built, which wind up deploying nothing.</li>
  <li>
<code class="highlighter-rouge">provider</code>: pages since you are deploying to GitHub Pages.</li>
</ul>

<h2 id="why">Why?</h2>

<p>Perhaps you are wondering why perform the building in your different branches and so. Well, have three permanent branches: <code class="highlighter-rouge">master</code>, <code class="highlighter-rouge">develop</code> and <code class="highlighter-rouge">writing</code>. I usually work on <code class="highlighter-rouge">develop</code> or <code class="highlighter-rouge">writing</code> and then I merge to <code class="highlighter-rouge">master</code>. I also use <a href="https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow">Git flow</a> for making changes in the source code of the site, and I’m thinking to try to implement it also for writing post and pages.</p>

<p>In other words, I think it’s a good idea to test that everything add up before I merge to <code class="highlighter-rouge">master</code> when I’m working on features. Writing, it’s much more simple, and usually the errors are just that some link isn’t correctly set, which is easy to fix. I sometimes use <a href="https://github.com/gjtorikian/html-proofer">htmlproofer</a> locally when I’m writing so I know everything is OK before I merge to <code class="highlighter-rouge">master</code>.</p>

<h2 id="lfs">LFS?</h2>

<p>At this moment, I have my configuration exactly like you can see above. However, while I was writing this post, I just discovered that you can use <a href="https://docs.travis-ci.com/user/customizing-the-build#git-lfs">LFS with Travis</a> —of course you can, why wouldn’t you? You <a href="https://github.com/git-lfs/git-lfs/issues/791#issuecomment-151318020">can’t use LFS with GitHub Pages</a> though, but I wonder if you implement the build of your site with Travis while using LFS, you’ll make it possible. Anyhow, you need to take into account the <a href="https://help.github.com/articles/about-storage-and-bandwidth-usage/">bandwidth limitations of LFS</a> and it’s probably that, every time you build with Travis you’ll use part of your bandwidth.</p>

<p>I’ll try to write a post in the near future about <a href="https://git-lfs.github.com">what is LFS (Large File Storage)</a>, but summing it up a lot, it’s just a system that allow you to manage better large binary files with Git, storing them in alternative storage instead of just tracking them with Git.</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>These scripts can be whatever you want —more or less. <a href="#fnref:1" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:2">
      <p>IIRC to trigger Travis you also need to have a <code class="highlighter-rouge">.travis.yml</code> file in the <code class="highlighter-rouge">root</code> of your repo but I’m not sure. Anyhow… sometimes I have repos in GitHub that have files <code class="highlighter-rouge">.travis.yml</code> and I don’t want they run in CI. In the end you can do whatever you think it’s more convenient for you. I don’t think it’s wise to try to build every time you are pushing to your repo and then receive an email of <em>your build is failing!</em>. <a href="#fnref:2" class="reversefootnote">↩</a></p>
    </li>
  </ol>
</div>

        </div>
        
      </section>

      <footer class="page__meta page__meta-footer">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/archive/tags/blogging" class="page__taxonomy-item" rel="tag">blogging</a><span class="sep">, </span>
    
      
      
      <a href="/archive/tags/ci" class="page__taxonomy-item" rel="tag">CI</a><span class="sep">, </span>
    
      
      
      <a href="/archive/tags/jekyll" class="page__taxonomy-item" rel="tag">jekyll</a><span class="sep">, </span>
    
      
      
      <a href="/archive/tags/travis" class="page__taxonomy-item" rel="tag">travis</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/archive/categories/personal" class="page__taxonomy-item" rel="tag">Personal</a><span class="sep">, </span>
    
      
      
      <a href="/archive/categories/technology" class="page__taxonomy-item" rel="tag">Technology</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Posted:</strong> <time datetime="2018-11-26T08:07:00+00:00">Monday, 26 November 2018 08:07 UTC</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=lpuerto&amp;text=How+I+publish+my+blog%3A+Using+Continuous+Integration+with+Jekyll%20https%3A%2F%2Fluispuerto.net%2Fblog%2F2018%2F11%2F26%2Fhow-i-publish-my-blog-ci%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fluispuerto.net%2Fblog%2F2018%2F11%2F26%2Fhow-i-publish-my-blog-ci%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>

  <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fluispuerto.net%2Fblog%2F2018%2F11%2F26%2Fhow-i-publish-my-blog-ci%2F&amp;title=How%20I%20publish%20my%20blog:%20Using%20Continuous%20Integration%20with%20Jekyll" class="btn btn--reddit" title="Share on Reddit"><i class="fab fa-fw fa-reddit" aria-hidden="true"></i><span> Reddit</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fluispuerto.net%2Fblog%2F2018%2F11%2F26%2Fhow-i-publish-my-blog-ci%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

</section>


      
  <nav class="pagination">
    
      <a href="/blog/2018/11/24/cleaning-geopackage-after-merging/" class="pagination--pager" title="Cleaning a GeoPackage after merging
">Previous</a>
    
    
      <a href="/blog/2018/12/03/how-i-schedule-post/" class="pagination--pager" title="How I schedule post in Jekyll
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Leave a comment</h4>
      <section id="disqus_thread"></section>
    
</div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
      <div class="archive__item-teaser">
          
            <a href="/blog/2019/02/21/no-message-no-connection-in-linkedin/" rel="permalink">
              <img src="/assets/images/blog/2019/linkedin-logo-header.png" alt="">
            </a>
          
      </div>

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/2019/02/21/no-message-no-connection-in-linkedin/" rel="permalink">No message, no connection in LinkedIn
</a>
      
    </h2>
    
    
      <p class="page__meta">
        
            <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> <time datetime="2018-11-26T08:07:00+00:00">Thursday, 21 February 2019 21:25 UTC</time>
        
        
          <i class="far fa-clock" aria-hidden="true"></i> 




  4 minute read

        
      </p>
    
    <p class="archive__item-excerpt" itemprop="description">I think this is something that almost anyone with a LinkedIn account has suffered or happened to them… an invitation to connect that comes out of the blue from someone you don’t know. No message, or just the standard message, no explanation, nothing… just an invitation in your LinkedIn inbox from someone, usually with a happy face —maybe a fake ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
      <div class="archive__item-teaser">
          
            <a href="/blog/2019/02/10/discovering-hypothesis/" rel="permalink">
              <img src="/assets/images/blog/2019/HypothesisBannerGoogleForms.png" alt="">
            </a>
          
      </div>

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/2019/02/10/discovering-hypothesis/" rel="permalink">Discovering Hypothes.is
</a>
      
    </h2>
    
    
      <p class="page__meta">
        
            <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> <time datetime="2018-11-26T08:07:00+00:00">Sunday, 10 February 2019 13:15 UTC</time>
        
        
          <i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read

        
      </p>
    
    <p class="archive__item-excerpt" itemprop="description">I just discovered Hypothes.is which is a service to annotate and highlight articles, posts, pdfs or whatever text you want and find all over the web and in any site. In their own words:

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
      <div class="archive__item-teaser">
          
            <a href="/blog/2019/02/03/what-Ive-been-doing-these-last-years/" rel="permalink">
              <img src="/assets/images/blog/2018/existential-nihilism-header.jpeg" alt="">
            </a>
          
      </div>

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/blog/2019/02/03/what-Ive-been-doing-these-last-years/" rel="permalink">What have I been doing these last years?
</a>
      
    </h2>
    
    
      <p class="page__meta">
        
            <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> <time datetime="2018-11-26T08:07:00+00:00">Sunday, 03 February 2019 19:30 UTC</time>
        
        
          <i class="far fa-clock" aria-hidden="true"></i> 




  19 minute read

        
      </p>
    
    <p class="archive__item-excerpt" itemprop="description">Since some people has asked me this once in a while, I think it’s going to be a good idea to write a small0 post about what I’ve been doing these last years since I left Spain. I think I’m going to give it the shape of an informal resume / curriculum where I’m going to talk, superficially, about each of the things I’ve been doing.
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap">
<div class="search-searchbar"></div>
    <div class="search-hits"></div>
</div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<!-- Font Academicons -->
<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">
<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/lpuerto" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/lpuerto" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://github.com/luispuerto" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2019 Luis Puerto |
  
  <a href="https://github.com/luispuerto/luispuerto.net"><i class="fas fa-code" aria-hidden="true"></i> Source Code</a> | 
  
Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.
</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>



<!-- Including InstantSearch.js library and styling -->
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch-theme-algolia.min.css">

<script>
// Instanciating InstantSearch.js with Algolia credentials
const search = instantsearch({
  appId: 'NSAWFR2G1K',
  apiKey: 'b63bbd39b0bf76207cf9bebdb9c2b7dd',
  indexName: 'luispuerto-net',
  searchParameters: {
    restrictSearchableAttributes: [
      'title',
      'content'
    ]
  }
});

const hitTemplate = function(hit) {
  const url = hit.url;
  const title = hit._highlightResult.title.value;
  const content = hit._highlightResult.html.value;

  return `
    <div class="list__item">
      <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
        <h2 class="archive__item-title" itemprop="headline"><a href="${url}">${title}</a></h2>
        <div class="archive__item-excerpt" itemprop="description">${content}</div>
      </article>
    </div>
  `;
}

// Adding searchbar and results widgets
search.addWidget(
  instantsearch.widgets.searchBox({
    container: '.search-searchbar',
    poweredBy: true,
    placeholder: 'Enter your search term...'
  })
);
search.addWidget(
  instantsearch.widgets.hits({
    container: '.search-hits',
    templates: {
      item: hitTemplate
    }
  })
);

// Starting the search
search.start();
</script>






  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1931812-1']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>





    
  <script>
    var disqus_config = function () {
      this.page.url = "https://luispuerto.net/blog/2018/11/26/how-i-publish-my-blog-ci/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/blog/2018/11/26/how-i-publish-my-blog-ci"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://luispuerto-net.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>


  



    <script>
//open external links in a new window
function external_new_window() {
    for(var c = document.getElementsByTagName("a"), a = 0;a < c.length;a++) {
    var b = c[a];
    b.getAttribute("href") && b.hostname !== location.hostname && (b.target = "_blank")
    }
}
//open PDF links in a new window
function pdf_new_window ()
{
    if (!document.getElementsByTagName) return false;
    var links = document.getElementsByTagName("a");
    for (var eleLink=0; eleLink < links.length; eleLink ++) {
    if ((links[eleLink].href.indexOf('.pdf') !== -1)||(links[eleLink].href.indexOf('.doc') !== -1)||(links[eleLink].href.indexOf('.docx') !== -1)) {
        links[eleLink].onclick =
        function() {
            window.open(this.href);
            return false;
        }
    }
    }
} 
pdf_new_window()
external_new_window();
</script>
    <style>
.videoWrapper {
	position: relative;
	padding-bottom: 56.333%;
	height: 0;
    background: black;
}
.videoWrapper iframe {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
    border: 0;
}    
</style>

<script>
function get_youtube_id(url) {
    var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
    return (url.match(p)) ? RegExp.$1 : false;
}
function vimeo_embed(url,el) {
    var id = false;
    $.ajax({
      url: 'https://vimeo.com/api/oembed.json?url='+url,
      async: true,
      success: function(response) {
        if(response.video_id) {
          id = response.video_id;
          if(url.indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
          if(url.indexOf('loop=1') !== -1) var loop=1; else var loop=0;
          var theInnerHTML = '<div class="videoWrapper"><iframe src="https://player.vimeo.com/video/'+id+'/?byline=0&title=0&portrait=0';
          if(autoplay==1) theInnerHTML += '&autoplay=1';
          if(loop==1) theInnerHTML += '&loop=1';
          theInnerHTML += '" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>'; 
          el.innerHTML = theInnerHTML;
        }
      }
    });
}
function video_embed() {
    var p = document.getElementsByTagName('p');
    for(var i = 0; i < p.length; i++) {
        //check if this is an external url (that starts with https:// or http://
        if (p[i].innerHTML.indexOf("http://") == 0 ||
            p[i].innerHTML.indexOf("https://") == 0) {
            var youtube_id = get_youtube_id(p[i].innerHTML);
            if(youtube_id) {
                if(p[i].innerHTML.indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
                if(p[i].innerHTML.indexOf('loop=1') !== -1) var loop=1; else var loop=0;
                var theInnerHTML = '<div class="videoWrapper"><iframe width="720" height="420" src="https://www.youtube.com/embed/' + youtube_id + '?rel=0&showinfo=0';
                if(autoplay==1) theInnerHTML += '&autoplay=1';
                if(loop==1) theInnerHTML += '&loop=1&playlist='+youtube_id+'&version=3';
                theInnerHTML += '" frameborder="0" allowfullscreen></iframe></div>';
                p[i].innerHTML = theInnerHTML;
            }
            if(p[i].innerHTML.indexOf('vimeo.com') !== -1) {
                //ask vimeo for the id and place the embed
                vimeo_embed(p[i].innerHTML,p[i]);
            }
        }
    }
}
video_embed();

function mp3_embed() {
    var p = document.getElementsByTagName('p');
    for(var i = 0; i < p.length; i++) {
        if(p[i].innerHTML.indexOf('.mp3') !== -1) {
            var str = p[i].innerHTML.split('?');
            if(str.length == 1) str[1] = '';
            var str1 = str[1];
            str1 = str1.replace('&','').replace('&','');
            str1 = str1.replace('autoplay=1','').replace('autoplay=0','');
            str1 = str1.replace('loop=1','').replace('loop=0','');
            str1 = str1.replace('controls=0','').replace('controls=1','');

            if (str[0].lastIndexOf('.mp3', str[0].length - 4) === str[0].length - 4 && str1.length == 0) {
                if(str[1].indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
                if(str[1].indexOf('loop=1') !== -1) var loop=1; else var loop=0;
                if(str[1].indexOf('controls=0') !== -1) var controls=0; else var controls=1;
                var newInnerHTML = '<audio';
                if(autoplay==1) newInnerHTML += ' autoplay';
                if(loop==1) newInnerHTML += ' loop';
                if(controls==1) newInnerHTML += ' controls';
                newInnerHTML += '><source src="'+str[0]+'" type="audio/mpeg">Your browser does not support the audio element.</audio>';
                p[i].innerHTML = newInnerHTML;
            }
        }
    }
}
mp3_embed();
</script>
  </body>
</html>
